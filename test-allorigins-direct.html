<!DOCTYPE html>
<html>
<head>
    <title>AllOrigins Direct Test</title>
    <style>
        body { font-family: monospace; padding: 20px; }
        button { padding: 10px; margin: 5px; }
        pre { background: #f0f0f0; padding: 10px; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>Test api.allorigins.win directly</h1>
    
    <button onclick="testDirect()">Test Direct URL</button>
    <button onclick="testWithHeaders()">Test With Headers</button>
    <button onclick="testGetMethod()">Test GET Method</button>
    <button onclick="testAllOriginsAPI()">Test AllOrigins API Format</button>
    
    <div id="results"></div>

    <script>
        async function testDirect() {
            const results = document.getElementById('results');
            results.innerHTML = '<h2>Testing direct URL...</h2>';
            
            const url = 'https://api.allorigins.win/raw?url=' + encodeURIComponent('https://vichealth.vic.gov.au');
            
            console.log('Testing:', url);
            
            try {
                const response = await fetch(url);
                const text = await response.text();
                
                results.innerHTML += `
                    <div class="success">
                        ✅ Success!<br>
                        Status: ${response.status}<br>
                        Length: ${text.length} bytes<br>
                        First 200 chars: <pre>${text.substring(0, 200)}</pre>
                    </div>
                `;
                console.log('Success:', response.status, text.length);
            } catch (error) {
                results.innerHTML += `
                    <div class="error">
                        ❌ Error: ${error.message}<br>
                        Type: ${error.name}
                    </div>
                `;
                console.error('Error:', error);
            }
        }
        
        async function testWithHeaders() {
            const results = document.getElementById('results');
            results.innerHTML = '<h2>Testing with headers...</h2>';
            
            const url = 'https://api.allorigins.win/raw?url=' + encodeURIComponent('https://vichealth.vic.gov.au');
            
            try {
                const response = await fetch(url, {
                    headers: {
                        'Accept': 'text/html',
                        'X-Requested-With': 'XMLHttpRequest'
                    },
                    mode: 'cors'
                });
                const text = await response.text();
                
                results.innerHTML += `
                    <div class="success">
                        ✅ Success with headers!<br>
                        Status: ${response.status}<br>
                        Length: ${text.length} bytes
                    </div>
                `;
            } catch (error) {
                results.innerHTML += `
                    <div class="error">
                        ❌ Error with headers: ${error.message}
                    </div>
                `;
                console.error('Error:', error);
            }
        }
        
        async function testGetMethod() {
            const results = document.getElementById('results');
            results.innerHTML = '<h2>Testing GET method explicitly...</h2>';
            
            const url = 'https://api.allorigins.win/raw?url=' + encodeURIComponent('https://vichealth.vic.gov.au');
            
            try {
                const response = await fetch(url, {
                    method: 'GET',
                    mode: 'cors'
                });
                const text = await response.text();
                
                results.innerHTML += `
                    <div class="success">
                        ✅ Success with GET!<br>
                        Status: ${response.status}<br>
                        Length: ${text.length} bytes
                    </div>
                `;
            } catch (error) {
                results.innerHTML += `
                    <div class="error">
                        ❌ Error: ${error.message}
                    </div>
                `;
            }
        }
        
        async function testAllOriginsAPI() {
            const results = document.getElementById('results');
            results.innerHTML = '<h2>Testing AllOrigins API format...</h2>';
            
            // Try the API endpoint that returns JSON
            const url = 'https://api.allorigins.win/get?url=' + encodeURIComponent('https://vichealth.vic.gov.au');
            
            try {
                const response = await fetch(url);
                const data = await response.json();
                
                results.innerHTML += `
                    <div class="success">
                        ✅ API Response:<br>
                        Status: ${data.status.http_code}<br>
                        URL: ${data.status.url}<br>
                        Content Length: ${data.contents ? data.contents.length : 0} bytes<br>
                        Content Type: ${data.status.content_type || 'unknown'}
                    </div>
                `;
                
                console.log('API Response:', data);
            } catch (error) {
                results.innerHTML += `
                    <div class="error">
                        ❌ API Error: ${error.message}
                    </div>
                `;
                console.error('API Error:', error);
            }
        }
    </script>
</body>
</html>